#!/usr/bin/env bash

config=/etc/alter-theme-changer.

# ウィンドウの基本型
function window () {
    zenity \
    --title="gtk-alter-theme-switcher" \
    $@
}

# 読み込みウィンドウ
function loading () {
    window \
        --progress \
        --auto-close \
        --pulsate \
        --width="$1" \
        --height="$2" \
        --text="$3"
}

# エラーウィンドウ
function error () {
    window \
        --error \
        --width="$1" \
        --height="$2" \
        --text="$3"
}

# 警告ウィンドウ
function warning () {
    window \
        --warning \
        --width="$1" \
        --height="$2" \
        --text="$3"
}

# 情報ウィンドウ
function info () {
    window \
        --info \
        --width="$1" \
        --height="$2" \
        --text="$3"
}

function setting () {
    select_light () {
        local theme
        window \
            --list \
            --checklist \
            --column="選択" \
            --column="テーマ" \
            --width="900" \
            --height="500" \
            --text="ライトテーマを選択してください。" \
            "$(
                for theme in $(ls /usr/share/themes/); do
                    if [[ -f "/usr/share/themes/${theme}/index.theme" ]]; then
                        echo "${theme}"
                    fi
                done
            )"
    }
    select_dark () {
        local theme
        window \
            --list \
            --checklist \
            --column="選択" \
            --column="テーマ" \
            --width="900" \
            --height="500" \
            --text="ダークテーマを選択してください。" \
            "$(
                for theme in $(ls /usr/share/themes/); do
                    if [[ -f "/usr/share/themes/${theme}/index.theme" ]]; then
                        echo "${theme}"
                    fi
                done
            )"
    }

    select_light_window () {
        local theme
        window \
            --list \
            --checklist \
            --column="選択" \
            --column="テーマ" \
            --width="900" \
            --height="500" \
            --text="ウィンドウライトテーマを選択してください。" \
            "$(
                for theme in $(ls /usr/share/themes/); do
                    if [[ -d "/usr/share/themes/${theme}/xfwm4/" ]]; then
                        echo "${theme}"
                    fi
                done
            )"
    }

    select_dark_window () {
        local theme
        window \
            --list \
            --checklist \
            --column="選択" \
            --column="テーマ" \
            --width="900" \
            --height="500" \
            --text="ウィンドウダークテーマを選択してください。" \
            "$(
                for theme in $(ls /usr/share/themes/); do
                    if [[ -d "/usr/share/themes/${theme}/xfwm4/" ]]; then
                        echo "${theme}"
                    fi
                done
            )"
    }
    
}

function top () {
    local exit_code
    run=$(
    window \
        --info \
        --text="実行する項目を選択してください。" \
        --ok-label="終了する" \
        --extra-button='テーマを切り替える' \
        --extra-button='テーマを設定する' \
        --width="200" \
        --height="120"
    )
    exit_code=${?}
    case $exit_code in
                0 ) exit 0 ;;
                * ) :;;
    esac

    case ${run} in
        "テーマを切り替える") alter-theme-switcher ;;
        "テーマを設定する") setting ;;
    esac
}

top